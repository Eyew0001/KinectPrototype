<html>

<head>
  <title>
    Kinect Output On Canvas
  </title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>
  <!-- <link rel="stylesheet" href="/style.css" />                                                      -->
</head>

<body>
  <h1>Kinect &amp; HTML5 WebSockets</h1>
  <canvas id="canvas" width="640" height="480"></canvas>
  <script>
    //initialise the socket by specifying the url and the port number:
    var socket = io.connect('http://localhost:8000/');

    //listens for incoming messages named “bodyFrame”.
    socket.on('bodyFrame', interpretData);

    //Inside the interpretData function we can pass in the a variable which will contain the received
    // message, which is the JSON formatted skeleton data in our case:
    function interpretData(bodyFrame) {
      //console.log(bodyFrame);      
      var ctx = document.getElementById('canvas').getContext('2d');
      ctx.fillStyle = "red";
      for (var i = 0; i < bodyFrame.bodies.length; i++) {
        if (bodyFrame.bodies[i].tracked == true) {
          // console.log('tracked');
          for (var j = 0; j < bodyFrame.bodies[i].joints.length; j++) {
            var joint = bodyFrame.bodies[i].joints[j];
            ctx.fillStyle = "#FF0000";
            ctx.beginPath();
            ctx.arc(joint.depthX * 400, joint.depthY * 400, 10, 0, Math.PI * 2,
              true
              ); //multiplied with static integer 400 in order to adjust position on canvas as without it 
              //skeleton projection formed is only visible in a corner as DepthX values were always less than 1
            ctx.closePath();
            ctx.fill(); //drawing a circle for each joint on the canvas 
          }
        }
      }
    }
  </script>

</body>